# MySQL vs PostgreSQL #

  OpenSource016： 石浩 shihao80   王红丽, cloudlhx   李想

## 项目介绍 ##
    当我们决定使用开源的关系数据库管理系统时，经常会考虑MySQL vs PostgreSQL。时间证明他们都是商业数据库软件的有力竞争者。这两个数据库相对比，MySQL被认为是速度较快但功能相对不全，PostgreSQL则被认为是具有更多丰富功能的数据库系统，称作是Oracle的开源版本。Mysql由于其速度快和易用性，在各种项目中都非常受欢迎，而PostgreSQL则更受那些有Oracle和SQLsever背景的开发者欢迎。
    然而，这些假设多半是过时的且不正确的。MySQL已经在功能的丰富上做了非常多的改进，同时PostgreSQL也在最近的一些版本中对他的速度做了提高。然而很多人忽略这种改进，依然坚持着基于MySQL 4.1和PostgreSQL 7.4的守旧观点。他们当前的最新版本分别是MySQL 5.6和PostgreSQL 9.1.4。

## 功能比较 ##
  1. 体系结构
    PostgreSQL是一个基于单一存储引擎的统一标准数据库服务器。MySQL是两层的层级结构，一个层位于上部的SQL层，另一层是存储引擎集合。当比较这两个系统，一个具有代表性方面就是详细列举当运用MySQL时选择哪一个存储引擎，因为不同的搜索引擎对于适用性、性能以及基础功能的可用性都有非常大的影响。在MySQL的所有引擎当中，InnoDB由于其对事务的ACID（原子性Atomicity、一致性Consistency、隔离性Isolation、持久性Durability）的高度支持以及其在高并发下的高负载性能上的表现而被广泛的使用，MyISAM由于其对低并发工作负载或高并发负载读功能，使其不需要具有ACID特性。应用程序可以依据需要结合使用多存储引擎来开发他们各自的优点。
   2. 性能
    数据库的性能可以根据他们的运行环境进行尽可能的优化。因此，如果不考虑配置和环境，很难精确的比较性能的优劣。PostgreSQL和MySQL都有在改进性能方面运用了很多技术。
    2.1早期情况
    MySQL将主要经历集中在速度方面，PostgreSQL则更强调功能的完备性以及标准性。因此在两者当中，MySQL被认为具有更快的速度。两者的默认配置都是将系统配置为一个较小的功能集上，进行性能测试通常也不更改默认配置，或者是将其中的一个修改成其最有名的配置，是常见的做法。任何一个变动都有导致具有误导性的结果。此外，两个DBMS的愿望都是能够和他们原始特点相关的方面（例如MySQL在简单操作方面有更快的速度，PostgreSQL则更加可靠，并且在复杂操作方面有不错的表现），在标准上有更好的表现。
    2.2 原始速度
    2.2.1 PostgreSQL
    PostgreSQL提供的主要性能特点：

    高效的执行静态SQL及参数化的SQL；
    基于开销的高级优化器，采用多计划的选择和自适应的统计收集；
    索引：局部的、功能的、多索引合并、4种不同的索引；
    TOAST（极大的属性存储技术The Oversized-Attribute Storage Technique）数据压缩
    版本8.1和8.2改进了cache管理
    在8.2以上版本，对写密集型负载有很大的延展性
    异步提交（MyISAM for Postgres）
    在9.0及其以上版本增加了异步复制
    在9.1及其以上版本增加了同步复制

    8.X版本的发布增加了75个分散的新性能特性。通过多年的计划，在可扩展性方面稳定的识别和修改关键的瓶颈来提高性能，同时增加底层优化和结构特性。文章[1]展示了8.3版本发布的新功能集。
    为了适应更多的数据在指定的磁盘空间，PostgreSQL运用一种高速压缩方案对数据进行快速的压缩和解压。这种被压缩的数据除了能够节省更多的磁盘空间，还能够在读数据过程中占用更少的IO，从而到达提高读速度的效果。
    PostgreSQL支持1个存储引擎，在存储引擎和数据库的其他部分严格的形成一个整体。像异步提交这样的设置，可以针对一个事务、一个用户或者是整个系统，允许不同事务类型有效的共存，同时他也不需要为每一个表提前选择存储类型。
    默认情况下，PostgreSQL在一个共享的服务器下运行，所以有低性能设置。当PostgreSQL在一个专属的服务器上运行，性能可以通过改变一些重要参数得到提高。
    2.2.2 MySQL:内核
    MySQL 5.1自带支持9种存储引擎：

    MyISAM
    InnoDB
    NDB Cluster
    MERGE
    MEMORY (HEAP)
    FEDERATED
    ARCHIVE
    CSV
    BLACKHOLE

    然而，FEDERATED和BLACKHOLE实际上不能算是真正的“存储”引擎（例如“BLACKHOLE”并不存储任何东西）。
    还有一些外部开发的存储引擎，其中比较流行的有：

      Aria (碰撞安全 MyISAM)
      XtraDB (提高了InnoDB fork的特点)
      NitroEDB
      BrightHouse

    MySQL还有一些定制的引擎正在开发中：

      PrimeBase XT
      FederatedODBC
      FederatedX
      IBM DB2
      memcached

    在一些发行版，默认的存储引擎是MyISAM，MyISAM对事物来说是不安全的。将默认存储引擎设置为例如像InnoDB这样支持事物的存储引擎是不重要的。从MySQL 5.5.1开始InnoDB为默认存储引擎。
    MySQL有一些查询cache，他在解析器判断一个查询是否在最近被处理之前做一个简单的匹配，如果这个查询最近有处理过，他就将结果直接反馈给客户端应用，这个过程不需要任何传统的数据库查询工作。这对于那些主要以读为主的工作负载有很重要的作用。查询的缓存在任何涉及的表改变时将会被移除，因为当数据改变的增加使得缓存失效了。
    MySQL的查询缓存在一个单一的线程上执行，每个select进行调用，所以他非常有可能在超过8核的机器上的某种情况下成为一个瓶颈，但是这种情况很少发生。他可以很容易的查看某个特定的任务这个开销是否值得。
    MySQL同样支持网络协议层的压缩，这个对于客户端是一个可开启的选项，只要他的服务端支持。他可以压缩往返于服务器的任何数据。
    2.2.3 MySQL:MyISAM
    MyISAM是传统的MySQL存储引擎，他更适合以读为主的负载。在简单查询、低并发或者遵循特定模式（例如count（*是非常快的））的情况下，MySQL的MyISAM引擎执行比PostgreSQL要快。MyISAM的速度是以不支持事务、外键以及保证数据永久性为代价的。
    在老的版本中，MyISAM需要独占执行select或者其他的数据修改类操作。近几个版本中，如果在update后没有删除和提交操作导致的忽略delete操作释放的空间，他通常支持操作的并发，但是禁止并发插入。
    MyISAM支持对keys进行前缀压缩，同时他还支持对只读压缩表进行数据压缩。
    系统表通常采用MyISAM作为存储引擎。他经常由于其丢失系统表的可能性遭到批判，但是也有声明这种情况在实际当中不可能发生，应为系统表在其写入的过程中通常不会发生修改而导致碰撞。

## 其他比较 ##
    进程模式与线程模式的对比
    PostgreSQL和oracle是进程模式，MySQL是线程模式。
    进程模式对多CPU利用率比较高。
    进程模式共享数据需要用到共享内存，而线程模式数据本身就是在进程空间内都是共享的，不同线程访问只需要控制好线程之间的同步。
    线程模式对资源消耗比较少。
    所以MySQL能支持远比oracle多的更多的连接。
    对于PostgreSQL的来说，如果不使用连接池软件，也存在这个问题，但PostgreSQL中有优秀的连接池软件软件，如pgbouncer和pgpool，所以通过连接池也可以支持很多的连接。

## 结合自身需要评估后的结论 ##
　　1. PostgreSQL完全免费，而且是BSD协议，如果你把PostgreSQL改一改，然后再拿去卖钱，也没有人管你，这一点很重要，这表明了PostgreSQL数据库不会被其它公司控制。oracle数据库不用说了，是商业数据库，不开放。而MySQL数据库虽然是开源的，但现在随着SUN被oracle公司收购，现在基本上被oracle公司控制，其实在SUN被收购之前，MySQL中最重要的InnoDB引擎也是被oracle公司控制的，而在MySQL中很多重要的数据都是放在InnoDB引擎中的，反正我们公司都是这样的。所以如果MySQL的市场范围与oracle数据库的市场范围冲突时，oracle公司必定会牺牲MySQL，这是毫无疑问的。
　　2. 与PostgreSQl配合的开源软件很多，有很多分布式集群软件，如pgpool、pgcluster、slony、plploxy等等，很容易做读写分离、负载均衡、数据水平拆分等方案，而这在MySQL下则比较困难。
    3. PostgreSQL源代码写的很清晰，易读性比MySQL强太多了，怀疑MySQL的源代码被混淆过。所以很多公司都是基本PostgreSQL做二次开发的。
    4. PostgreSQL在很多方面都比MySQL强，如复杂SQL的执行、存储过程、触发器、索引。同时PostgreSQL是多进程的，而MySQL是线程的，虽然并发不高时，MySQL处理速度快，但当并发高的时候，对于现在多核的单台机器上，MySQL的总体处理性能不如PostgreSQL，原因是MySQL的线程无法充分利用CPU的能力。

## 组员贡献 ##
王红丽 石浩 李想
## 参考资料 ##
http://www.wikivs.com/wiki/MySQL_vs_PostgreSQL
http://bbs.chinaunix.net/thread-1688208-1-1.html
